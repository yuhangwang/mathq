////////////////////////////////////////////////////////////////////////////////
// File: catalan_beta_function_pos_int_arg.c                                  //
// Routine(s):                                                                //
//    Catalan_Beta_Function_pos_int_arg                                       //
//    xCatalan_Beta_Function_pos_int_arg                                      //
//    Catalan_Beta_Star_Function_int_arg                                      //
//    xCatalan_Beta_Star_Function_int_arg                                     //
////////////////////////////////////////////////////////////////////////////////
#include <math.h>          // required for powl()
#define CUTOFF 42          // first argument for which |beta*()| < LDBL_EPSILON

//                         Internally Defined Routines                        //

double      Catalan_Beta_Function_pos_int_arg(int s);
long double xCatalan_Beta_Function_pos_int_arg(int s);
double      Catalan_Beta_Star_Function_pos_int_arg(int s);
long double xCatalan_Beta_Star_Function_pos_int_arg(int s);
                                                                                
               // beta_star table: beta_star[k] = beta*(k) //

static long double beta_star[] = {
    -5.00000000000000000000000000000000000e-1L,
    -2.14601836602551690384339154180124279e-1L,
    -8.40344058227809849453964850676158892e-2L,
    -3.10538537406306195163651541530813999e-2L,
    -1.10554482588946638915773667716221787e-2L,
    -3.84217192291193599368063136902471849e-3L,
    -1.31477778156186455839921213979345032e-3L,
    -4.45492109460090503653450100941016998e-4L,
    -1.50009753170343661932940759536218524e-4L,
    -5.03158127799101786411267061524726273e-5L,
    -1.68359738031225944592700416658585431e-5L,
    -5.62502617630083081754857051677381596e-6L,
    -1.87764941211779345703292661765843757e-6L,
    -6.26416228158887196386460133537219133e-7L,
    -2.08912751266147766753581352043370901e-7L,
    -6.96591573756128393024186785506334472e-8L,
    -2.32240490967894227108516210298254156e-8L,
    -7.74221789571157548518688484241567530e-9L,
    -2.58091325531691587140729576843258386e-9L,
    -8.60339255440967087639674310992074203e-10L,
    -2.86786725770970995315151519766368421e-10L,
    -9.55969709891034031964088828520990446e-11L,
    -3.18659362776120506602195359352887422e-11L,
    -1.06220346347627395143284535055074623e-11L,
    -3.54068938946343089944406406544833119e-12L,
    -1.18023203245847339120741677674154118e-12L,
    -3.93411124736858664677641795961754812e-13L,
    -1.31137131037181965903087204058592133e-13L,
    -4.37123949051962230085676516728304824e-14L,
    -1.45708018804578198268398618729414720e-14L,
    -4.85693467592138047587570025569123031e-15L,
    -1.61897836846425775446685287480985574e-15L,
    -5.39659484786661210906028547535585944e-16L,
    -1.79886500655337730269099803190293220e-16L,
    -5.99621680304125582078043707143228767e-17L,
    -1.99873895725322562736343199038964355e-17L,
    -6.66246323665656718766229968749683967e-18L,
    -2.22082108804804747298561262966174115e-18L,
    -7.40273697848524943494585336320028564e-19L,
    -2.46757899649344057942016323458411159e-19L,
    -8.22526332897485850930886899219822451e-20L,
    -2.74175444445763201524731585581441492e-20L,
    -9.13918148445746678452653254045641441e-21L,
    -3.04639382873889451912209779559387900e-21L,
    -1.01546460969691265945041505801709271e-21L,
    -3.38488203255760455416000301522874286e-22L,
    -1.12829401089944732970500039590605829e-22L,
    -3.76098003642531606582474401925600251e-23L,
    -1.25366001216053701675626238413580014e-23L,
    -4.17886670723932004755938635694600755e-24L,
    -1.39295556908727934782404387652019987e-24L,
    -4.64318523030594315711228133971591475e-25L,
    -1.54772841010498345197104065436316589e-25L,
    -5.15909470035594963919048632444815312e-26L,
    -1.71969823345318417293324995902785928e-26L,
    -5.73232744484634916286798656434316115e-27L,
    -1.91077581494926343824328014889437079e-27L,
    -6.36925271649850556205577063962885762e-28L,
    -2.12308423883302734093473865471009578e-28L,
    -7.07694746277714211028216060774586359e-29L,
    -2.35898248759245756486076486992763394e-29L,
    -7.86327495864167893906945554248302832e-30L,
    -2.62109165288059039092988780099941253e-30L,
    -8.73697217626869612557979518409769949e-31L,
    -2.91232405875624433968930326996091218e-31L,
    -9.70774686252083906128976023007218295e-32L,
    -3.23591562084028460622833750173304937e-32L,
    -1.07863854028009585256912944639593754e-32L,
    -3.59546180093365480954979889506553043e-33L,
    -1.19848726697788533004713980578659612e-33L,
    -3.99495755659295188721821307131664297e-34L,
    -1.33165251886431745315162043948711948e-34L,
    -4.43884172954772515866316697063826674e-35L,
    -1.47961390984924178251927542576586140e-35L,
    -4.93204636616413940099402429187365269e-36L,
    -1.64401545538804649218396267204316951e-36L,
    -5.48005151796015502431845138996370085e-37L,
    -1.82668383932005168484719895999698915e-37L,
    -6.08894613106683896963942686007261066e-38L,
    -2.02964871035561299390956168538327612e-38L,
    -6.76549570118537665442471108200888918e-39L,
    -2.25516523372845888642013812015110304e-39L,
    -7.51721744576152962462426258613597521e-40L,
    -2.50573914858717654218618129917216834e-40L,
    -8.35246382862392180857679187149479563e-41L,
    -2.78415460954130726978350146534919039e-41L,
    -9.28051536513769089979414656753259684e-42L,
    -3.09350512171256363336787719245127403e-42L,
    -1.03116837390418787780992473147184198e-42L,
    -3.43722791301395959274101377288231111e-43L,
    -1.14574263767131986425525752455600507e-43L,
    -3.81914212557106621420069761571048699e-44L,
    -1.27304737519035540473686704534158977e-44L,
    -4.24349125063451801579615916468148760e-45L,
    -1.41449708354483933860004019093573356e-45L,
    -4.71499027848279779533610824186958726e-46L,
    -1.57166342616093259844589760170662417e-46L,
    -5.23887808720310866148738171452227075e-47L,
    -1.74629269573436955382933851327412829e-47L,
    -5.82097565244789851276488426111383703e-48L,
    -1.94032521748263283758837926374462756e-48L,
    -6.46775072494210945862809989922878896e-49L,
    -2.15591690831403648620940043709226907e-49L,
    -7.18638969438012162069806906500624241e-50L,
    -2.39546323146004054023270320994181657e-50L,
    -7.98487743820013513410903774301886011e-51L,
    -2.66162581273337837803635132298218101e-51L,
    -8.87208604244459459345451522722572531e-52L,
    -2.95736201414819819781817390586559949e-52L,
    -9.85787338049399399272725067979938043e-53L,
    -3.28595779349799799757575109198260323e-53L,
    -1.09531926449933266585858387040409636e-53L,
    -3.65106421499777555286194658083344511e-54L,
    -1.21702140499925851762064892950843982e-54L,
    -4.05673801666419505873549657015604895e-55L,
    -1.35224600555473168624516555107759956e-55L,
    -4.50748668518243895415055189230983170e-56L,
    -1.50249556172747965138351730851351053e-56L,
    -5.00831853909159883794505771719883503e-57L,
    -1.66943951303053294598168591016370500e-57L,
    -5.56479837676844315327228637607386996e-58L,
    -1.85493279225614771775742879379692731e-58L,
    -6.18310930752049239252476264953436570e-59L,
    -2.06103643584016413084158755055371017e-59L,
    -6.87012145280054710280529183659687708e-60L,
    -2.29004048426684903426843061248252767e-60L,
    -7.63346828088949678089476870884222950e-61L,
    -2.54448942696316559363158956972750396e-61L
};


////////////////////////////////////////////////////////////////////////////////
// double Catalan_Beta_Function_pos_int_arg(int s)                            //
//                                                                            //
//  Description:                                                              //
//     This routine calculates the Catalan Beta function                      //
//        beta(s) = Sum (-1)^k (1/(2k+1)^s) where the sum extends over        //
//     k = 0,... and where s > 1 is an integer,                               //
//     beta(0) = 1 / 2 and beta(1) = pi / 4.                                  //
//                                                                            //
//  Arguments:                                                                //
//     int s                                                                  //
//        The argument of the beta function restricted to the non-negative    //
//        integers.                                                           //
//                                                                            //
//  Return Value:                                                             //
//     beta(s)                                                                //
//                                                                            //
//  Example:                                                                  //
//     int    s;                                                              //
//     double beta;                                                           //
//                                                                            //
//     ( User code to set s, the argument to the beta function. )             //
//                                                                            //
//     if ( s >= 0 ) beta = Catalan_Beta_Function_pos_int_arg(s);             //
//     else printf(" Error argument, %d, is negative\n",s);                   //
////////////////////////////////////////////////////////////////////////////////

double Catalan_Beta_Function_pos_int_arg(int s)
{
   return (double) xCatalan_Beta_Function_pos_int_arg(s);
}


////////////////////////////////////////////////////////////////////////////////
// long double xCatalan_Beta_Function_pos_int_arg(int s)                      //
//                                                                            //
//  Description:                                                              //
//     This routine calculates the Catalan Beta function                      //
//        beta(s) = Sum (-1)^k (1/(2k+1)^s) where the sum extends over        //
//     k = 0,... and where s > 1 is an integer,                               //
//     beta(0) = 1 / 2 and beta(1) = pi / 4.                                  //
//                                                                            //
//  Arguments:                                                                //
//     int s                                                                  //
//        The argument of the beta function restricted to the non-negative    //
//        integers.                                                           //
//                                                                            //
//  Return Value:                                                             //
//     beta(s)                                                                //
//                                                                            //
//  Example:                                                                  //
//     int    s;                                                              //
//     long double beta;                                                      //
//                                                                            //
//     ( User code to set s, the argument to the beta function. )             //
//                                                                            //
//     if ( s >= 0 ) beta = xCatalan_Beta_Function_pos_int_arg(s);            //
//     else printf(" Error argument, %d, is negative\n",s);                   //
////////////////////////////////////////////////////////////////////////////////

long double xCatalan_Beta_Function_pos_int_arg(int s)
{
   if (s < 0) return 0.0L;
   if (s > CUTOFF) return 1.0L;
   return 1.0L + xCatalan_Beta_Star_Function_pos_int_arg(s);
}


////////////////////////////////////////////////////////////////////////////////
// double Catalan_Beta_Star_Function_pos_int_arg(int s)                       //
//                                                                            //
//  Description:                                                              //
//     This routine calculates the beta star function defined for             //
//     for integer arguments s >= 0 as beta*(s) = beta(s) - 1, where beta()   //
//     is the Catalan beta function, i.e.                                     //
//        beta*(s) = Sum (-1)^k (1/(2k+1)^s) where the sum extends over       //
//     k = 1,... and where s > 1 is an integer,                               //
//     beta*(0) = - 1 / 2 and beta*(1) = pi / 4 - 1.                          //
//                                                                            //
//  Arguments:                                                                //
//     int s                                                                  //
//        The argument of the beta* function defined above.                   //
//                                                                            //
//  Return Value:                                                             //
//     beta*(s)                                                               //
//                                                                            //
//  Example:                                                                  //
//     int    s;                                                              //
//     double beta;                                                           //
//                                                                            //
//     ( User code to set s, the argument to the beta* function. )            //
//                                                                            //
//     if ( s >= 0 ) beta = Catalan_Beta_Star_Function_pos_int_arg(s);        //
//     else printf(" Error argument, %d, is negative.\n",s);                  //
////////////////////////////////////////////////////////////////////////////////

double Catalan_Beta_Star_Function_pos_int_arg(int s)
{
   return (double) xCatalan_Beta_Star_Function_pos_int_arg(s);
}


////////////////////////////////////////////////////////////////////////////////
// long double xCatalan_Beta_Star_Function_pos_int_arg(int s)                 //
//                                                                            //
//  Description:                                                              //
//     This routine calculates the beta star function defined for             //
//     for integer arguments s >= 0 as beta*(s) = beta(s) - 1, where beta()   //
//     is the Catalan beta function, i.e.                                     //
//        beta*(s) = Sum (-1)^k (1/(2k+1)^s) where the sum extends over       //
//     k = 1,... and where s > 1 is an integer,                               //
//     beta*(0) = - 1 / 2 and beta*(1) = pi / 4 - 1.                          //
//                                                                            //
//  Arguments:                                                                //
//     int s                                                                  //
//        The argument of the beta* function defined above.                   //
//                                                                            //
//  Return Value:                                                             //
//     beta*(s)                                                               //
//                                                                            //
//  Example:                                                                  //
//     int    s;                                                              //
//     long double beta;                                                      //
//                                                                            //
//     ( User code to set s, the argument to the beta* function. )            //
//                                                                            //
//     if ( s >= 0 ) eta = xCatalan_Beta_Star_Function_pos_int_arg(s);        //
//     else printf(" Error argument, %d, is negative.\n",s);                  //
////////////////////////////////////////////////////////////////////////////////

long double xCatalan_Beta_Star_Function_pos_int_arg(int s)
{
   static int max_beta_star_index = sizeof(beta_star) / sizeof(long double) - 1;
   int diff;
   
   if ( s <= max_beta_star_index ) return beta_star[s];

           // For large positive integer s, use the approximation //
           //              beta*(s+1) = beta*(s) / 3.             //

   diff = s - max_beta_star_index;
   return beta_star[max_beta_star_index] / powl(3.0L, (long double) diff);
}
