////////////////////////////////////////////////////////////////////////////////
// File: dirichlet_eta_pos_int_arg.c                                          //
// Routine(s):                                                                //
//    Dirichlet_Eta_Function_pos_int_arg                                      //
//    xDirichlet_Eta_Function_pos_int_arg                                     //
//    Dirichlet_Eta_Star_Function_int_arg                                     //
//    xDirichlet_Eta_Star_Function_int_arg                                    //
////////////////////////////////////////////////////////////////////////////////
#include <math.h>          // required for powl()
#define CUTOFF 64          // first argument for which |eta*()| < LDBL_EPSILON

//                         Internally Defined Routines                        //

double      Dirichlet_Eta_Function_pos_int_arg(int s);
long double xDirichlet_Eta_Function_pos_int_arg(int s);
double      Dirichlet_Eta_Star_Function_pos_int_arg(int s);
long double xDirichlet_Eta_Star_Function_pos_int_arg(int s);
                                                                                
                 // eta_star table: eta_star[0] = eta*(2) //

static long double eta_star[] = {
    -1.775329665758867817640e-1L,   -9.845732263030428595000e-2L,
    -5.296717050275408242350e-2L,   -2.788022955309069406469e-2L,
    -1.444890870256489590109e-2L,   -7.406180077169717329375e-3L,
    -3.766998147352100772398e-3L,   -1.905702458394669232070e-3L,
    -9.604924017284343589277e-4L,   -4.828565019392458559058e-4L,
    -2.423148561418091468203e-4L,   -1.214572367348845078250e-4L,
    -6.082965402028182904581e-5L,   -3.044878690076191736707e-5L,
    -1.523578509389355831723e-5L,   -7.621707958988023062128e-6L,
    -3.812130389886520310774e-6L,   -1.906491828324893143507e-6L,
    -9.533884184778849491574e-7L,   -4.767417844571836833357e-7L,
    -2.383867691774521027951e-7L,   -1.191986815604967761752e-7L,
    -5.960110760537163859686e-8L,   -2.980114303716558486689e-8L,
    -1.490076800343121233819e-8L,   -7.450449515036484147258e-9L,
    -3.725246599891272472330e-9L,   -1.862630581887813253435e-9L,
    -9.313177185460213727205e-10L,  -4.656596685457824853137e-10L,
    -2.328301040485091771847e-10L,  -1.164151419539695273453e-10L,
    -5.820760095468407611963e-11L,  -2.910381047019047741525e-11L,
    -1.455190856611523604489e-11L,  -7.275955393415249942845e-12L,
    -3.637978066831244498071e-12L,  -1.818989156791264449873e-12L,
    -9.094946195211219089515e-13L,  -4.547473234691264255663e-13L,
    -2.273736663041022650156e-13L,  -1.136868346752351239387e-13L,
    -5.684341784534663599526e-14L,  -2.842170909191661190229e-14L,
    -1.421085460237280456180e-14L,  -7.105427319991251978742e-15L,
    -3.552713666263913428962e-15L,  -1.776356835221386912770e-15L,
    -8.881784183071704520900e-16L,  -4.440892093857442903496e-16L,
    -2.220446047702585163771e-16L,  -1.110223024109247193646e-16L,
    -5.551115121406084776810e-17L,  -2.775557560989658683611e-17L,
    -1.387778780590368113294e-17L,  -6.938893903270303154146e-18L,
    -3.469446951741305776978e-18L,  -1.734723475906037622793e-18L,
    -8.673617379648137230824e-19L,  -4.336808689863384988324e-19L,
    -2.168404344944797951956e-19L,  -1.084202172476767461949e-19L,
    -5.421010862398398929744e-20L,  -2.710505431204053338230e-20L,
    -1.355252715603644626907e-20L,  -6.776263578023616327190e-21L,
    -3.388131789013605894484e-21L,  -1.694065894507402190873e-21L,
    -8.470329472539008433134e-22L,  -4.235164736270170042825e-22L,
    -2.117582368135306963498e-22L,  -1.058791184067727462445e-22L,
    -5.293955920338883914541e-23L,  -2.646977960169524158043e-23L,
    -1.323488980084789479279e-23L,  -6.617444900424038730587e-24L,
    -3.308722450212049810024e-24L,  -1.654361225106035053256e-24L,
    -8.271806125530209093757e-25L,  -4.135903062765115822705e-25L,
    -2.067951531382561669961e-25L,  -1.033975765691282087850e-25L,
    -5.169878828456414615482e-26L,  -2.584939414228208699819e-26L,
    -1.292469707114104813935e-26L,  -6.462348535570525616428e-27L,
    -3.231174267785263323798e-27L,  -1.615587133892631833760e-27L,
    -8.077935669463159741673e-28L,  -4.038967834731580061794e-28L,
    -2.019483917365790094549e-28L,  -1.009741958682895068492e-28L,
    -5.048709793414475413185e-29L,  -2.524354896707237730168e-29L,
    -1.262177448353618872942e-29L,  -6.310887241768094390905e-30L,
    -3.155443620884047204184e-30L,  -1.577721810442023605002e-30L,
    -7.888609052210118034714e-31L,  -3.944304526105059020591e-31L,
    -1.972152263052529511373e-31L,  -9.860761315262647560460e-32L,
    -4.930380657631323781428e-32L,  -2.465190328815661891113e-32L,
    -1.232595164407830945690e-32L,  -6.162975822039154728892e-33L,
    -3.081487911019577364594e-33L,  -1.540743955509788682346e-33L,
    -7.703719777548943411895e-34L,  -3.851859888774471706002e-34L,
    -1.925929944387235853019e-34L,  -9.629649721936179265158e-35L,
    -4.814824860968089632599e-35L,  -2.407412430484044816306e-35L,
    -1.203706215242022408155e-35L,  -6.018531076210112040785e-36L,
    -3.009265538105056020395e-36L,  -1.504632769052528010198e-36L,
    -7.523163845262640050994e-37L,  -3.761581922631320025498e-37L,
    -1.880790961315660012749e-37L,  -9.403954806578300063748e-38L,
    -4.701977403289150031874e-38L,  -2.350988701644575015937e-38L,
    -1.175494350822287507969e-38L,  -5.877471754111437539843e-39L,
    -2.938735877055718769922e-39L,  -1.469367938527859384961e-39L,
    -7.346839692639296924805e-40L,  -3.673419846319648462402e-40L,
    -1.836709923159824231201e-40L,  -9.183549615799121156006e-41L,
    -4.591774807899560578003e-41L,  -2.295887403949780289001e-41L,
    -1.147943701974890144501e-41L,  -5.739718509874450722504e-42L,
    -2.869859254937225361252e-42L,  -1.434929627468612680626e-42L,
    -7.174648137343063403129e-43L,  -3.587324068671531701565e-43L,
    -1.793662034335765850782e-43L,  -8.968310171678829253912e-44L,
    -4.484155085839414626956e-44L,  -2.242077542919707313478e-44L,
    -1.121038771459853656739e-44L,  -5.605193857299268283695e-45L,
    -2.802596928649634141847e-45L,  -1.401298464324817070924e-45L,
    -7.006492321624085354619e-46L,  -3.503246160812042677309e-46L,
    -1.751623080406021338655e-46L,  -8.758115402030106693273e-47L,
    -4.379057701015053346637e-47L,  -2.189528850507526673318e-47L,
    -1.094764425253763336659e-47L,  -5.473822126268816683296e-48L,
    -2.736911063134408341648e-48L,  -1.368455531567204170824e-48L,
    -6.842277657836020854120e-49L,  -3.421138828918010427060e-49L,
    -1.710569414459005213530e-49L,  -8.552847072295026067650e-50L,
    -4.276423536147513033825e-50L,  -2.138211768073756516912e-50L,
    -1.069105884036878258456e-50L,  -5.345529420184391292281e-51L,
    -2.672764710092195646141e-51L,  -1.336382355046097823070e-51L,
    -6.681911775230489115351e-52L,  -3.340955887615244557676e-52L,
    -1.670477943807622278838e-52L,  -8.352389719038111394189e-53L,
    -4.176194859519055697095e-53L,  -2.088097429759527848547e-53L,
    -1.044048714879763924274e-53L,  -5.220243574398819621368e-54L,
    -2.610121787199409810684e-54L,  -1.305060893599704905342e-54L,
    -6.525304467998524526710e-55L,  -3.262652233999262263355e-55L,
    -1.631326116999631131678e-55L,  -8.156630584998155658388e-56L,
    -4.078315292499077829194e-56L,  -2.039157646249538914597e-56L,
    -1.019578823124769457298e-56L,  -5.097894115623847286492e-57L,
    -2.548947057811923643246e-57L,  -1.274473528905961821623e-57L,
    -6.372367644529809108116e-58L,  -3.186183822264904554058e-58L,
    -1.593091911132452277029e-58L,  -7.965459555662261385144e-59L,
    -3.982729777831130692572e-59L,  -1.991364888915565346286e-59L,
    -9.956824444577826731431e-60L,  -4.978412222288913365715e-60L,
    -2.489206111144456682858e-60L,  -1.244603055572228341429e-60L,
    -6.223015277861141707144e-61L
};

static const long double log_2 = 0.6931471805599453094172321L;

////////////////////////////////////////////////////////////////////////////////
// double Dirichlet_Eta_Function_pos_int_arg(int s)                           //
//                                                                            //
//  Description:                                                              //
//     This routine calculates the Eta function                               //
//        eta(s) = Sum (-1)^(k-1) (1/k^s) = (1 - 2^(1-s)) zeta(s), where the  //
//     sum is summed over k = 1,... and for s > 1 is an integer,              //
//     eta(0) = 1/2 and eta(1) = ln(2).                                       //
//                                                                            //
//  Arguments:                                                                //
//     int s                                                                  //
//        The argument of the eta function restricted to the positive         //
//        integers.                                                           //
//                                                                            //
//  Return Value:                                                             //
//     eta(s)                                                                 //
//                                                                            //
//  Example:                                                                  //
//     int    s;                                                              //
//     double eta;                                                            //
//                                                                            //
//     ( User code to set s, the argument to the eta function. )              //
//                                                                            //
//     if ( s >= 1 ) eta = Dirichlet_Eta_Function_pos_int_arg(s);             //
//     else printf(" Error argument, %d, is not positive\n",s);               //
////////////////////////////////////////////////////////////////////////////////

double Dirichlet_Eta_Function_pos_int_arg(int s)
{
   return (double) xDirichlet_Eta_Function_pos_int_arg(s);
}


////////////////////////////////////////////////////////////////////////////////
// long double xDirichlet_Eta_Function_pos_int_arg(int s)                     //
//                                                                            //
//  Description:                                                              //
//     This routine calculates the Eta function                               //
//        eta(s) = Sum (-1)^(k-1) (1/k^s) = (1 - 2^(1-s)) zeta(s), where the  //
//     sum is summed over k = 1,... and for s > 1 is an integer,              //
//     eta(0) = 1/2 and eta(1) = ln(2).                                       //
//                                                                            //
//  Arguments:                                                                //
//     int s                                                                  //
//        The argument of the eta function restricted to the positive         //
//        integers.                                                           //
//                                                                            //
//  Return Value:                                                             //
//     eta(s)                                                                 //
//                                                                            //
//  Example:                                                                  //
//     int    s;                                                              //
//     long double eta;                                                       //
//                                                                            //
//     ( User code to set s, the argument to the eta function. )              //
//                                                                            //
//     if ( s >= 1 ) eta = xDirichlet_Eta_Function_pos_int_arg(s);            //
//     else printf(" Error argument, %d, is not positive\n",s);               //
////////////////////////////////////////////////////////////////////////////////

long double xDirichlet_Eta_Function_pos_int_arg(int s)
{
   if (s < 0) return 0.0L;
   if (s > CUTOFF) return 1.0L;
   if (s == 0) return 0.5L;
   if (s == 1) return (double) log_2;
   return 1.0L + xDirichlet_Eta_Star_Function_pos_int_arg(s);
}


////////////////////////////////////////////////////////////////////////////////
// double Dirichlet_Eta_Star_Function_pos_int_arg(int s)                      //
//                                                                            //
//  Description:                                                              //
//     This routine calculates the eta star function defined for              //
//     for integer arguments s >= 1 as eta*(s) = eta(s) - 1, where eta() is   //
//     the eta function, i.e. eta*(s) = Sum(-1)^(k-1) (1/k^s), summed over    //
//     k = 2,... for s >= 1 an integer.                                       //
//     eta*(0) = -1/2 and eta*(1) = ln(2) - 1.                                //
//                                                                            //
//  Arguments:                                                                //
//     int s                                                                  //
//        The argument of the eta* function defined above.                    //
//                                                                            //
//  Return Value:                                                             //
//     eta*(s)                                                                //
//                                                                            //
//  Example:                                                                  //
//     int    s;                                                              //
//     double eta;                                                            //
//                                                                            //
//     ( User code to set s, the argument to the eta* function. )             //
//                                                                            //
//     if ( s >= 1 ) eta = Dirichlet_Eta_Star_Function_pos_int_arg(s);        //
//     else printf(" Error argument, %d, is less than 1.\n",s);               //
////////////////////////////////////////////////////////////////////////////////

double Dirichlet_Eta_Star_Function_pos_int_arg(int s)
{
   return (double) xDirichlet_Eta_Star_Function_pos_int_arg(s);
}


////////////////////////////////////////////////////////////////////////////////
// long double xDirichlet_Eta_Star_Function_pos_int_arg(int s)                //
//                                                                            //
//  Description:                                                              //
//     This routine calculates the eta star function defined for              //
//     for integer arguments s >= 1 as eta*(s) = eta(s) - 1, where eta() is   //
//     the eta function, i.e. eta*(s) = Sum(-1)^(k-1) (1/k^s), summed over    //
//     k = 2,... for s >= 1 an integer.                                       //
//     eta*(0) = -1/2 and eta*(1) = ln(2) - 1.                                //
//                                                                            //
//  Arguments:                                                                //
//     int s                                                                  //
//        The argument of the eta* function defined above.                    //
//                                                                            //
//  Return Value:                                                             //
//     eta*(s)                                                                //
//                                                                            //
//  Example:                                                                  //
//     int    s;                                                              //
//     long double eta;                                                       //
//                                                                            //
//     ( User code to set s, the argument to the eta* function. )             //
//                                                                            //
//     if ( s >= 1 ) eta = xDirichlet_Eta_Star_Function_pos_int_arg(s);       //
//     else printf(" Error argument, %d, is less than 1.\n",s);               //
////////////////////////////////////////////////////////////////////////////////

long double xDirichlet_Eta_Star_Function_pos_int_arg(int s)
{
   static int max_eta_star_index = sizeof(eta_star) / sizeof(long double) - 1;
   int k = s - 2;
   int diff;
   
   if ( s == 0 ) return -0.5L;
   if ( s == 1 ) return log_2 - 1.0L;
   if ( k <= max_eta_star_index ) return eta_star[k];

           // For large positive integer s, use the approximation //
           //               eta*(s+1) = eta*(s) / 2.              //

   diff = s - max_eta_star_index - 2;
   return eta_star[max_eta_star_index] / powl(2.0L, (long double) diff);
}
