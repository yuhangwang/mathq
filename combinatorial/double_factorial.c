////////////////////////////////////////////////////////////////////////////////
// File: double_factorial.c                                                   //
// Routine(s):                                                                //
//    Double_Factorial                                                        //
//    xDouble_Factorial                                                       //
//    Double_Factorial_Max_Arg                                                //
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
//                                                                            //
//  Description:                                                              //
//     The double factorial n!! is defined as:                                //
//                   n!! = n (n - 2) ... 2,  if n is even and                 //
//                   n!! = n (n - 2) ... 1,  if n is odd                      //
//     where by convention (-1)!! = 0!! = 1.                                  //
//                                                                            //
//     The functions Double_Factorial(n) and xDouble_Factorial(n) return n!!  //
//     for -1 <= n <= Double_Factorial_Max_Arg().                             //
//     If n > Double_Factorial_Max_Arg(), then DBL_MAX is returned and        //
//     if n < -1, then 0 is returned.                                         //
//     The function Double_Factorial_Max_Arg() returns the maximum argument   //
//     to the functions Double_Factorial() and xDouble_Factorial().           //
////////////////////////////////////////////////////////////////////////////////

#include <float.h>                         // required for DBL_MAX

//                         Internally Defined Routines                        //

double Double_Factorial(int n);
long double xDouble_Factorial(int n);
int Double_Factorial_Max_Arg( void );

//                         Internally Defined Constants                       //

static long double const double_factorials[] = {
       1.000000000000000000000e+0L,          //   0!!
       1.000000000000000000000e+0L,          //   1!!
       2.000000000000000000000e+0L,          //   2!!
       3.000000000000000000000e+0L,          //   3!!
       8.000000000000000000000e+0L,          //   4!!
       1.500000000000000000000e+1L,          //   5!!
       4.800000000000000000000e+1L,          //   6!!
       1.050000000000000000000e+2L,          //   7!!
       3.840000000000000000000e+2L,          //   8!!
       9.450000000000000000000e+2L,          //   9!!
       3.840000000000000000000e+3L,          //  10!!
       1.039500000000000000000e+4L,          //  11!!
       4.608000000000000000000e+4L,          //  12!!
       1.351350000000000000000e+5L,          //  13!!
       6.451200000000000000000e+5L,          //  14!!
       2.027025000000000000000e+6L,          //  15!!
       1.032192000000000000000e+7L,          //  16!!
       3.445942500000000000000e+7L,          //  17!!
       1.857945600000000000000e+8L,          //  18!!
       6.547290750000000000000e+8L,          //  19!!
       3.715891200000000000000e+9L,          //  20!!
       1.374931057500000000000e+10L,         //  21!!
       8.174960640000000000000e+10L,         //  22!!
       3.162341432250000000000e+11L,         //  23!!
       1.961990553600000000000e+12L,         //  24!!
       7.905853580625000000000e+12L,         //  25!!
       5.101175439360000000000e+13L,         //  26!!
       2.134580466768750000000e+14L,         //  27!!
       1.428329123020800000000e+15L,         //  28!!
       6.190283353629375000000e+15L,         //  29!!
       4.284987369062400000000e+16L,         //  30!!
       1.918987839625106250000e+17L,         //  31!!
       1.371195958099968000000e+18L,         //  32!!
       6.332659870762850625000e+18L,         //  33!!
       4.662066257539891200000e+19L,         //  34!!
       2.216430954766997718750e+20L,         //  35!!
       1.678343852714360832000e+21L,         //  36!!
       8.200794532637891559375e+21L,         //  37!!
       6.377706640314571161600e+22L,         //  38!!
       3.198309867728777708156e+23L,         //  39!!
       2.551082656125828464640e+24L,         //  40!!
       1.311307045768798860344e+25L,         //  41!!
       1.071454715572847955149e+26L,         //  42!!
       5.638620296805835099479e+26L,         //  43!!
       4.714400748520531002655e+27L,         //  44!!
       2.537379133562625794766e+28L,         //  45!!
       2.168624344319444261221e+29L,         //  46!!
       1.192568192774434123540e+30L,         //  47!!
       1.040939685273333245386e+31L,         //  48!!
       5.843584144594727205346e+31L,         //  49!!
       5.204698426366666226931e+32L,         //  50!!
       2.980227913743310874726e+33L,         //  51!!
       2.706443181710666438004e+34L,         //  52!!
       1.579520794283954763605e+35L,         //  53!!
       1.461479318123759876522e+36L,         //  54!!
       8.687364368561751199827e+36L,         //  55!!
       8.184284181493055308524e+37L,         //  56!!
       4.951797690080198183901e+38L,         //  57!!
       4.746884825265972078944e+39L,         //  58!!
       2.921560637147316928502e+40L,         //  59!!
       2.848130895159583247366e+41L,         //  60!!
       1.782151988659863326386e+42L,         //  61!!
       1.765841154998941613367e+43L,         //  62!!
       1.122755752855713895623e+44L,         //  63!!
       1.130138339199322632555e+45L,         //  64!!
       7.297912393562140321551e+45L,         //  65!!
       7.458913038715529374863e+46L,         //  66!!
       4.889601303686634015439e+47L,         //  67!!
       5.072060866326559974907e+48L,         //  68!!
       3.373824899543777470653e+49L,         //  69!!
       3.550442606428591982435e+50L,         //  70!!
       2.395415678676082004164e+51L,         //  71!!
       2.556318676628586227353e+52L,         //  72!!
       1.748653445433539863039e+53L,         //  73!!
       1.891675820705153808241e+54L,         //  74!!
       1.311490084075154897280e+55L,         //  75!!
       1.437673623735916894263e+56L,         //  76!!
       1.009847364737869270905e+57L,         //  77!!
       1.121385426514015177525e+58L,         //  78!!
       7.977794181429167240152e+58L,         //  79!!
       8.971083412112121420203e+59L,         //  80!!
       6.462013286957625464523e+60L,         //  81!!
       7.356288397931939564567e+61L,         //  82!!
       5.363471028174829135554e+62L,         //  83!!
       6.179282254262829234236e+63L,         //  84!!
       4.558950373948604765221e+64L,         //  85!!
       5.314182738666033141443e+65L,         //  86!!
       3.966286825335286145742e+66L,         //  87!!
       4.676480810026109164470e+67L,         //  88!!
       3.529995274548404669711e+68L,         //  89!!
       4.208832729023498248023e+69L,         //  90!!
       3.212295699839048249437e+70L,         //  91!!
       3.872126110701618388181e+71L,         //  92!!
       2.987435000850314871976e+72L,         //  93!!
       3.639798544059521284890e+73L,         //  94!!
       2.838063250807799128377e+74L,         //  95!!
       3.494206602297140433495e+75L,         //  96!!
       2.752921353283565154526e+76L,         //  97!!
       3.424322470251197624825e+77L,         //  98!!
       2.725392139750729502981e+78L,         //  99!!
       3.424322470251197624825e+79L,         // 100!!
       2.752646061148236798011e+80L,         // 101!!
       3.492808919656221577321e+81L,         // 102!!
       2.835225442982683901951e+82L,         // 103!!
       3.632521276442470440414e+83L,         // 104!!
       2.976986715131818097048e+84L,         // 105!!
       3.850472553029018666839e+85L,         // 106!!
       3.185375785191045363842e+86L,         // 107!!
       4.158510357271340160186e+87L,         // 108!!
       3.472059605858239446588e+88L,         // 109!!
       4.574361392998474176205e+89L,         // 110!!
       3.853986162502645785712e+90L,         // 111!!
       5.123284760158291077349e+91L,         // 112!!
       4.355004363627989737855e+92L,         // 113!!
       5.840544626580451828178e+93L,         // 114!!
       5.008255018172188198533e+94L,         // 115!!
       6.775031766833324120686e+95L,         // 116!!
       5.859658371261460192284e+96L,         // 117!!
       7.994537484863322462410e+97L,         // 118!!
       6.972993461801137628817e+98L,         // 119!!
       9.593444981835986954892e+99L,         // 120!!
       8.437322088779376530869e+100L,        // 121!!
       1.170400287783990408497e+102L,        // 122!!
       1.037790616919863313297e+103L,        // 123!!
       1.451296356852148106536e+104L,        // 124!!
       1.297238271149829141621e+105L,        // 125!!
       1.828633409633706614235e+106L,        // 126!!
       1.647492604360283009859e+107L,        // 127!!
       2.340650764331144466221e+108L,        // 128!!
       2.125265459624765082718e+109L,        // 129!!
       3.042845993630487806088e+110L,        // 130!!
       2.784097752108442258360e+111L,        // 131!!
       4.016556711592243904036e+112L,        // 132!!
       3.702850010304228203619e+113L,        // 133!!
       5.382185993533606831408e+114L,        // 134!!
       4.998847513910708074886e+115L,        // 135!!
       7.319772951205705290715e+116L,        // 136!!
       6.848421094057670062594e+117L,        // 137!!
       1.010128667266387330119e+119L,        // 138!!
       9.519305320740161387006e+119L,        // 139!!
       1.414180134172942262166e+121L,        // 140!!
       1.342222050224362755568e+122L,        // 141!!
       2.008135790525578012276e+123L,        // 142!!
       1.919377531820838740462e+124L,        // 143!!
       2.891715538356832337677e+125L,        // 144!!
       2.783097421140216173670e+126L,        // 145!!
       4.221904686000975213009e+127L,        // 146!!
       4.091153209076117775295e+128L,        // 147!!
       6.248418935281443315253e+129L,        // 148!!
       6.095818281523415485189e+130L,        // 149!!
       9.372628402922164972880e+131L,        // 150!!
       9.204685605100357382635e+132L,        // 151!!
       1.424639517244169075878e+134L,        // 152!!
       1.408316897580354679543e+135L,        // 153!!
       2.193944856556020376852e+136L,        // 154!!
       2.182891191249549753292e+137L,        // 155!!
       3.422553976227391787889e+138L,        // 156!!
       3.427139170261793112668e+139L,        // 157!!
       5.407635282439279024864e+140L,        // 158!!
       5.449151280716251049143e+141L,        // 159!!
       8.652216451902846439782e+142L,        // 160!!
       8.773133561953164189120e+143L,        // 161!!
       1.401659065208261123245e+145L,        // 162!!
       1.430020770598365762827e+146L,        // 163!!
       2.298720866941548242121e+147L,        // 164!!
       2.359534271487303508664e+148L,        // 165!!
       3.815876639122970081921e+149L,        // 166!!
       3.940422233383796859469e+150L,        // 167!!
       6.410672753726589737628e+151L,        // 168!!
       6.659313574418616692502e+152L,        // 169!!
       1.089814368133520255397e+154L,        // 170!!
       1.138742621225583454418e+155L,        // 171!!
       1.874480713189654839282e+156L,        // 172!!
       1.970024734720259376143e+157L,        // 173!!
       3.261596440949999420351e+158L,        // 174!!
       3.447543285760453908250e+159L,        // 175!!
       5.740409736071998979819e+160L,        // 176!!
       6.102151615796003417602e+161L,        // 177!!
       1.021792933020815818408e+163L,        // 178!!
       1.092285139227484611751e+164L,        // 179!!
       1.839227279437468473134e+165L,        // 180!!
       1.977036102001747147269e+166L,        // 181!!
       3.347393648576192621104e+167L,        // 182!!
       3.617976066663197279502e+168L,        // 183!!
       6.159204313380194422831e+169L,        // 184!!
       6.693255723326914967079e+170L,        // 185!!
       1.145612002288716162647e+172L,        // 186!!
       1.251638820262133098844e+173L,        // 187!!
       2.153750564302786385775e+174L,        // 188!!
       2.365597370295431556815e+175L,        // 189!!
       4.092126072175294132973e+176L,        // 190!!
       4.518290977264274273516e+177L,        // 191!!
       7.856882058576564735309e+178L,        // 192!!
       8.720301586120049347886e+179L,        // 193!!
       1.524235119363853558650e+181L,        // 194!!
       1.700458809293409622838e+182L,        // 195!!
       2.987500833953152974954e+183L,        // 196!!
       3.349903854308016956991e+184L,        // 197!!
       5.915251651227242890409e+185L,        // 198!!
       6.666308670072953744411e+186L,        // 199!!
       1.183050330245448578082e+188L,        // 200!!
       1.339928042684663702627e+189L,        // 201!!
       2.389761667095806127725e+190L,        // 202!!
       2.720053926649867316332e+191L,        // 203!!
       4.875113800875444500559e+192L,        // 204!!
       5.576110549632227998481e+193L,        // 205!!
       1.004273442980341567115e+195L,        // 206!!
       1.154254883773871195686e+196L,        // 207!!
       2.088888761399110459600e+197L,        // 208!!
       2.412392707087390798983e+198L,        // 209!!
       4.386666398938131965159e+199L,        // 210!!
       5.090148611954394585854e+200L,        // 211!!
       9.299732765748839766137e+201L,        // 212!!
       1.084201654346286046787e+203L,        // 213!!
       1.990142811870251709953e+204L,        // 214!!
       2.331033556844515000592e+205L,        // 215!!
       4.298708473639743693499e+206L,        // 216!!
       5.058342818352597551284e+207L,        // 217!!
       9.371184472534641251828e+208L,        // 218!!
       1.107777077219218863731e+210L,        // 219!!
       2.061660583957621075402e+211L,        // 220!!
       2.448187340654473688846e+212L,        // 221!!
       4.576886496385918787393e+213L,        // 222!!
       5.459457769659476326126e+214L,        // 223!!
       1.025222575190445808376e+216L,        // 224!!
       1.228377998173382173378e+217L,        // 225!!
       2.317003019930407526930e+218L,        // 226!!
       2.788418055853577533569e+219L,        // 227!!
       5.282766885441329161400e+220L,        // 228!!
       6.385477347904692551873e+221L,        // 229!!
       1.215036383651505707122e+223L,        // 230!!
       1.475045267365983979483e+224L,        // 231!!
       2.818884410071493240523e+225L,        // 232!!
       3.436855472962742672195e+226L,        // 233!!
       6.596189519567294182824e+227L,        // 234!!
       8.076610361462445279657e+228L,        // 235!!
       1.556700726617881427146e+230L,        // 236!!
       1.914156655666599531279e+231L,        // 237!!
       3.704947729350557796609e+232L,        // 238!!
       4.574834407043172879756e+233L,        // 239!!
       8.891874550441338711861e+234L,        // 240!!
       1.102535092097404664021e+236L,        // 241!!
       2.151833641206803968270e+237L,        // 242!!
       2.679160273796693333572e+238L,        // 243!!
       5.250474084544601682579e+239L,        // 244!!
       6.563942670801898667251e+240L,        // 245!!
       1.291616624797972013915e+242L,        // 246!!
       1.621293839688068970811e+243L,        // 247!!
       3.203209229498970594508e+244L,        // 248!!
       4.037021660823291737319e+245L,        // 249!!
       8.008023073747426486270e+246L,        // 250!!
       1.013292436866646226067e+248L,        // 251!!
       2.018021814584351474540e+249L,        // 252!!
       2.563629865272614951950e+250L,        // 253!!
       5.125775409044252745332e+251L,        // 254!!
       6.537256156445168127472e+252L,        // 255!!
       1.312198504715328702805e+254L,        // 256!!
       1.680074832206408208760e+255L,        // 257!!
       3.385472142165548053237e+256L,        // 258!!
       4.351393815414597260689e+257L,        // 259!!
       8.802227569630424938416e+258L,        // 260!!
       1.135713785823209885040e+260L,        // 261!!
       2.306183623243171333865e+261L,        // 262!!
       2.986927256715041997655e+262L,        // 263!!
       6.088324765361972321403e+263L,        // 264!!
       7.915357230294861293785e+264L,        // 265!!
       1.619494387586284637493e+266L,        // 266!!
       2.113400380488727965441e+267L,        // 267!!
       4.340244958731242828482e+268L,        // 268!!
       5.685047023514678227036e+269L,        // 269!!
       1.171866138857435563690e+271L,        // 270!!
       1.540647743372477799527e+272L,        // 271!!
       3.187475897692224733237e+273L,        // 272!!
       4.205968339406864392708e+274L,        // 273!!
       8.733683959676695769070e+275L,        // 274!!
       1.156641293336887707995e+277L,        // 275!!
       2.410496772870768032263e+278L,        // 276!!
       3.203896382543178951145e+279L,        // 277!!
       6.701181028580735129692e+280L,        // 278!!
       8.938870907295469273695e+281L,        // 279!!
       1.876330688002605836314e+283L,        // 280!!
       2.511822724950026865908e+284L,        // 281!!
       5.291252540167348458405e+285L,        // 282!!
       7.108458311608576030520e+286L,        // 283!!
       1.502715721407526962187e+288L,        // 284!!
       2.025910618808444168698e+289L,        // 285!!
       4.297766963225527111855e+290L,        // 286!!
       5.814363475980234764164e+291L,        // 287!!
       1.237756885408951808214e+293L,        // 288!!
       1.680351044558287846843e+294L,        // 289!!
       3.589494967685960243821e+295L,        // 290!!
       4.889821539664617634314e+296L,        // 291!!
       1.048132530564300391196e+298L,        // 292!!
       1.432717711121732966854e+299L,        // 293!!
       3.081509639859043150115e+300L,        // 294!!
       4.226517247809112252220e+301L,        // 295!!
       9.121268533982767724342e+302L,        // 296!!
       1.255275622599306338909e+304L,        // 297!!
       2.718138023126864781854e+305L,        // 298!!
       3.753274111571925953339e+306L,        // 299!!
       8.154414069380594345561e+307L         // 300!!
                                        };

static const int N = sizeof(double_factorials) / sizeof(long double);

////////////////////////////////////////////////////////////////////////////////
// double Double_Factorial( int n )                                           //
//                                                                            //
//  Description:                                                              //
//     This function computes n!! for -1 <= n <= Double_Factorial_Max_Arg().  //
//     If n > Double_Factorial_Max_Arg(), then DBL_MAX is returned and if     //
//     n < -1, then 0 is returned.                                            //
//                                                                            //
//  Arguments:                                                                //
//     int    n   Argument of the Double Factorial function.                  //
//                                                                            //
//  Return Values:                                                            //
//     If n < -1, then 0 is returned.  If n > Double_Factorial_Max_Arg(),     //
//     then DBL_MAX is returned.  If -1 <= n <= Double_Factorial_Max_Arg(),   //
//     then n!! is returned.                                                  //
//                                                                            //
//  Example:                                                                  //
//     int n;                                                                 //
//     double x;                                                              //
//                                                                            //
//     x = Double_Factorial( n );                                             //
////////////////////////////////////////////////////////////////////////////////

double Double_Factorial(int n) {

               // For an argument n < -1, return 0.0 //

   if ( n < -1 ) return 0.0;


           // For a large postive argument (n >= N) return DBL_MAX //

   if ( n >= N ) return DBL_MAX;

                          // Otherwise return n!!. //

   if (n == -1) return 1.0;
   return (double) double_factorials[n];
}


////////////////////////////////////////////////////////////////////////////////
// long double xDouble_Factorial( int n )                                     //
//                                                                            //
//  Description:                                                              //
//     This function computes n!! for -1 <= n <= Double_Factorial_Max_Arg().  //
//     If n > Double_Factorial_Max_Arg(), then DBL_MAX is returned and if     //
//     n < -1, then 0 is returned.                                            //
//                                                                            //
//  Arguments:                                                                //
//     int    n   Argument of the Double Factorial function.                  //
//                                                                            //
//  Return Values:                                                            //
//     If n < -1, then 0 is returned.  If n > Double_Factorial_Max_Arg(),     //
//     then DBL_MAX is returned.  If -1 <= n <= Double_Factorial_Max_Arg(),   //
//     then n!! is returned.                                                  //
//                                                                            //
//  Example:                                                                  //
//     int n;                                                                 //
//     long double x;                                                         //
//                                                                            //
//     x = xDouble_Factorial( n );                                            //
////////////////////////////////////////////////////////////////////////////////
long double xDouble_Factorial(int n) {

               // For an argument n < -1, return 0.0 //

   if ( n < -1 ) return 0.0L;


           // For a large postive argument (n >= N) return DBL_MAX //

   if ( n >= N ) return (long double) DBL_MAX;

                          // Otherwise return n!!. //

   if (n == -1) return 1.0L;
   return double_factorials[n];
}


////////////////////////////////////////////////////////////////////////////////
// int Double_Factorial_Max_Arg( void )                                       //
//                                                                            //
//  Description:                                                              //
//     This function returns the maximum argument of the Double Factorial     //
//     function for which a positive number < DBL_MAX is returned.            //
//                                                                            //
//  Arguments:                                                                //
//     none                                                                   //
//                                                                            //
//  Return Values:                                                            //
//     N-1                                                                    //
//                                                                            //
//  Example:                                                                  //
//     int x;                                                                 //
//                                                                            //
//     x = Double_Factorial_Max_Arg();                                        //
////////////////////////////////////////////////////////////////////////////////
int Double_Factorial_Max_Arg( void ) { return N - 1; }
